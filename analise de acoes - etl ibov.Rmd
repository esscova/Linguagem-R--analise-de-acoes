# ETL - Dados de ações Índice Bovespa

#### Importando bibliotecas

```{r}
library(yfR)
library(plyr)
library(dplyr)
```

#### Extração de dados

```{r}
#extraindo dados com api da lib yfr
ibov<-yf_collection_get('IBOV')
```

#### Manipulando dados extraídos

```{r}
# dividindo o dataframe
acoes<-dlply(ibov, .(ticker), function(x){rownames(x)=x$row; x$row=NULL; x})

# filtrando colunas - iniciando pelo primeiro dataset
dados_acoes<-acoes[[1]][,c(2,8)]

# mudando nomes das colunas e adicionando ticker a coluna preço
colnames(dados_acoes)<-c("Data",paste("Preço", acoes[[1]][8,1]))

# iterando em loop para novo dataset
for (i in 2:83){
  dados_acoes_loop <- acoes[[i]][,c(2,8)]
  colnames(dados_acoes_loop)<-c("Data",paste("Preço", acoes[[i]][8,1]))
  dados_acoes<-merge(dados_acoes,dados_acoes_loop, by = "Data")}
```
